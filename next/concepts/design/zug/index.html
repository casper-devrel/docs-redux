<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-concepts/design/zug" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Zug Consensus | Casper Docs - Redux</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://casper-devrel.github.io/docs-redux/next/concepts/design/zug/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Zug Consensus | Casper Docs - Redux"><meta data-rh="true" name="description" content="The Casper node was designed with a pluggable consensus protocol in mind. So far the only choice was Highway. Casper 2.0.0 has added Zug, a much simpler consensus protocol."><meta data-rh="true" property="og:description" content="The Casper node was designed with a pluggable consensus protocol in mind. So far the only choice was Highway. Casper 2.0.0 has added Zug, a much simpler consensus protocol."><link data-rh="true" rel="icon" href="/docs-redux/icon/favicon.ico"><link data-rh="true" rel="canonical" href="https://casper-devrel.github.io/docs-redux/next/concepts/design/zug/"><link data-rh="true" rel="alternate" href="https://casper-devrel.github.io/docs-redux/next/concepts/design/zug/" hreflang="en"><link data-rh="true" rel="alternate" href="https://casper-devrel.github.io/docs-redux/next/concepts/design/zug/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://A1AAQ71KTN-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/docs-redux/blog/rss.xml" title="Casper Docs - Redux RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs-redux/blog/atom.xml" title="Casper Docs - Redux Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Casper Docs - Redux" href="/docs-redux/opensearch.xml"><link rel="stylesheet" href="/docs-redux/assets/css/styles.73c81181.css">
<script src="/docs-redux/assets/js/runtime~main.a9d99ed6.js" defer="defer"></script>
<script src="/docs-redux/assets/js/main.ba0daeae.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">This is an Alpha version of the Decs Redux, any suggestions please email to devrel@casper.network</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs-redux/"><div class="navbar__logo"><img src="/docs-redux/icon/Casper_Wordmark_Red_RGB.png" alt="Casper Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs-redux/icon/Casper_Wordmark_Red_RGB.png" alt="Casper Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs-redux/concepts/">Concepts</a><a class="navbar__item navbar__link" href="/docs-redux/developers/">Developers</a><a class="navbar__item navbar__link" href="/docs-redux/operators/">Operators</a><a class="navbar__item navbar__link" href="/docs-redux/users/">Users</a><a class="navbar__item navbar__link" href="/docs-redux/resources/">Resources</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs-redux/blog/tags/condor/">Condor</a><a class="navbar__item navbar__link" href="/docs-redux/blog/">Blog</a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs-redux/next/concepts/design/zug/">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs-redux/next/concepts/design/zug/">Next</a></li><li><a class="dropdown__link" href="/docs-redux/">1.5.6</a></li></ul></div><a href="https://support.casperlabs.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://discord.com/invite/casperblockchain" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chat<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/casper-network/docs/blob/dev/README.md" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-redux/next/concepts/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-redux/next/">What is Casper?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs-redux/next/design/">Design</a><button aria-label="Collapse sidebar category &#x27;Design&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs-redux/next/concepts/design/casper-design/">Network Design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs-redux/next/concepts/design/p2p/">Network Communication</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs-redux/next/concepts/design/consensus/">Consensus</a><button aria-label="Collapse sidebar category &#x27;Consensus&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs-redux/next/concepts/design/zug/">Zug Consensus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs-redux/next/concepts/design/highway/">Highway Consensus</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs-redux/next/concepts/design/rewards/">Rewards Design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs-redux/next/concepts/design/reading-and-writing-to-the-blockchain/">Reading and Writing Data</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs-redux/next/economics/">Economics</a><button aria-label="Expand sidebar category &#x27;Economics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs-redux/next/glossary/">Glossary</a><button aria-label="Expand sidebar category &#x27;Glossary&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs-redux/next/concepts/serialization/">Binary Serialization Standard</a><button aria-label="Expand sidebar category &#x27;Binary Serialization Standard&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-redux/next/concepts/intro-to-dapps/">dApps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-redux/next/concepts/addressable-entity/">Addressable Entities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-redux/next/concepts/accounts-and-keys/">Accounts and Keys</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-redux/next/concepts/key-types/">Key Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-redux/next/transactions-and-transaction-lifecycle/">Transaction Lifecycle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-redux/next/concepts/global-state/">Global State</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-redux/next/concepts/smart-contracts/">Smart Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-redux/next/concepts/list-auth-keys/">Authorization Keys</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-redux/next/concepts/callstack/">Call Stacks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-redux/next/concepts/dictionaries/">Dictionaries</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->Casper Docs - Redux<!-- --> <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs-redux/">latest version</a></b> (<!-- -->1.5.6<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs-redux/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs-redux/next/design/"><span itemprop="name">Design</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs-redux/next/concepts/design/consensus/"><span itemprop="name">Consensus</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Zug Consensus</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Next</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Simple and Fast Consensus with Zug</h1></header>
<p>The Casper node was designed with a pluggable consensus protocol in mind. So far the only choice was Highway. Casper 2.0.0 has added Zug, <a href="https://arxiv.org/abs/2205.06314" target="_blank" rel="noopener noreferrer">a much simpler consensus protocol</a>.</p>
<p>The Zug protocol requires that at most one-third of the validator weight could be attributed to faulty validators. It also assumes that there exists an upper bound for the network delay, which is the duration for a correct validator to deliver a message. The value of the upper bound may be unknown, but it exists. Under these conditions, all correct nodes will reach agreement on a chain of finalized blocks.</p>
<p>Of course, all nodes in a network have to run the same protocol to work together, but when starting a new network or upgrading an existing one, either <code>Highway</code> or <code>Zug</code> can now be selected as the <code>consensus_protocol</code> in the chainspec file. The Casper Mainnet will switch to Zug.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-zug-works">How Zug Works<a href="#how-zug-works" class="hash-link" aria-label="Direct link to How Zug Works" title="Direct link to How Zug Works">​</a></h2>
<p>In every round, the designated leader can sign a <strong>proposal message</strong> to suggest a block. The proposal also points to an earlier round in which the parent block was proposed.</p>
<p>Each validator then signs an <strong>echo message</strong> with the proposal&#x27;s hash. Correct validators only sign one echo per round, so at most one proposal can get echo messages signed by a quorum. A <strong>quorum</strong> is a set of validators whose total weight is greater than <code>(n + f) / 2</code>, where <code>n</code> is the total weight of all validators and <code>f</code> is the maximum allowed total weight of faulty validators. Thus, any two quorums always have a correct validator in common. As long as <code>n &gt; 3f</code>, the correct validators will constitute a quorum since <code>(n + f) / 2 &lt; n - f</code>.</p>
<p>The proposal is accepted if there is a quorum and some other conditions are met (see below). Now, the next round&#x27;s leader can make a new proposal that uses this proposal as a parent.</p>
<p>Each validator observing the proposal in time signs a <code>Vote(true)</code> message. If validators time out while waiting, they sign <code>Vote(false)</code> message instead. If a quorum signs <em>true</em>, the round is committed and the proposal and all its ancestors are finalized. If a quorum signs <em>false</em>, the round is <strong>skippable</strong>, meaning that the next round&#x27;s leader can propose a block with a parent from an earlier round. Correct validators only sign either <em>true</em> or <em>false</em>, so a round can be either committed or skippable, but not both.</p>
<p>If there is no accepted proposal, all correct validators will eventually vote <em>false</em>, so the round becomes skippable. This is what makes the protocol <strong>live</strong>. The next leader will eventually be allowed to make a proposal because either there is an accepted proposal that can be the parent, or the round will eventually be skippable, and an earlier round&#x27;s proposal can be used as a parent. If the timeout is long enough, the correct proposers&#x27; blocks will usually get finalized.</p>
<p>For a proposal to be accepted, the parent proposal must also be accepted, and all rounds between the parent and the current round must be skippable. This is what makes the protocol <strong>safe</strong>. If two rounds are committed, their proposals must be ancestors of each other because they are not skippable. Thus, the protocol cannot finalize two conflicting blocks.</p>
<p>Of course, there is also a first block. Whenever all earlier rounds are skippable (particularly the first round), the leader may propose a block with no parent.</p>
<p>Every new signed message is optimistically sent directly to all peers. We want to guarantee that it is eventually seen by all validators, even if they are not fully connected. This is achieved via a pull-based randomized gossip mechanism, where a <code>SyncRequest</code> message containing information about a random part of the local protocol state is periodically sent to a random peer. The peer compares that to its local state and responds with all the signed messages that it has recorded.</p>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p>The Zug protocol can be summarized as follows:</p><ul>
<li>In every round, the round leader proposes a new block, <code>B</code>.</li>
<li>Every validator creates and broadcasts an <em>echo</em> message, with a signature of <code>B</code>.</li>
<li>When a suitable block <code>B</code> has received echoes from 67% of the validators:
<ul>
<li>The next round begins. The next leader can propose a child of <code>B</code>.</li>
<li>Every validator signs and broadcasts a <em>vote</em> message, voting <code>yes</code>.</li>
</ul>
</li>
<li>If this does not happen before a timeout, the validators vote <code>no</code> instead.
<ul>
<li>If there are <code>no</code> votes from 67%, the next round begins, too.
The next leader can propose a child from an earlier block and skip this round.</li>
</ul>
</li>
<li>If there are <code>yes</code> votes from 67%, <code>B</code> is finalized and gets executed, together with all its ancestors. (Usually, the next round has already started at this point.)</li>
</ul></div></div>
<p>Notice that proposals, votes, and echoes are broadcast, so if one correct node receives a message, all nodes will eventually receive it. An honest validator sends only one echo or vote per round. So, unless 34% of validators double-sign, at most one block per round gets 67% echoes, and no finalized block can ever be skipped, ensuring safety. As long as there are 67% of echoes for a proposal, the next round begins and Zug doesn&#x27;t get stuck. If there are not, everyone votes <code>no</code>, and the next round also begins.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>Expand to see a simple example</b></summary><div><div class="collapsibleContent_i85q">
<!-- -->
<p>Let&#x27;s review a simple scenario demonstrating the Zug consensus. The example shows five rounds with a different leader and nodes voting on a card suit. The bottom row indicates whether or not the round was finalized. Notice that round 5 was the first finalized round.</p>
<p align="center">
<img decoding="async" loading="lazy" src="{&quot;/image/design/zug-example.png&quot;}" alt="Zug Example" class="img_ev3q">
</p>
<p>In round 1, we had a leader who proposed <code>♥</code>, but was slow, so the other nodes timed out and voted <code>no.</code> The first round had a proposal and was skippable, but nothing was finalized.</p>
<p>In round 2, the second proposer saw <code>♥</code> and proposed <code>♣</code> as a child of <code>♥</code>. Some nodes voted <code>yes</code>, and some timed out and voted <code>no</code>. So, round 2 will never output anything because there wasn&#x27;t a decision.</p>
<p>In round 3, the leader proposed <code>♦</code> as a child of <code>♣</code>. Assuming the leader was still too slow, everyone voted <code>no</code>, and round 3 became skippable even though it had a proposal.</p>
<p>In round 4, the proposer might have crashed or been malicious, so everyone timed out and voted <code>no</code>.</p>
<p>In round 5, the leader didn&#x27;t see the <code>♦</code> proposal from round 3 but saw the <code>no</code> decision. So, from their perspective, rounds 3 and 4 were skippable and had no proposals. Thus, the leader in round 5 proposed <code>♠</code> as a child of <code>♣</code>. <strong>Notice that the algorithm encountered a fork</strong>. Regardless, everyone voted <code>yes</code>, and round 5 was finalized. I.e., at that moment, <code>♥</code>, <code>♣</code>, and <code>♠</code> all become finalized and executed in that order. As a result, every future proposer needs to propose children of this round.</p>
<p><strong>Important Notes:</strong></p>
<p>Even proposals from rounds with a quorum of <code>no</code> votes can become finalized indirectly.</p>
<p>If a round is neither finalized nor skippable, the round will likely be finalized at some point in the future. When one-third of the network&#x27;s weight votes <code>yes</code>, a proposal with a quorum of echoes is formed. Consequently, all other honest nodes will eventually see this quorum of echoes and the accepted proposal, which will serve as a parent in future rounds.</p>
<p>Nodes vote <code>yes</code> when they have a quorum of echoes, and all the ancestors of that proposal have a quorum of echoes. Also, those ancestors have a quorum of echoes, and the rounds with no ancestors all have a quorum of <code>no</code> votes (being skippable).</p>
<p>The algorithm will always produce a result in at least one of the <code>Accepted proposal</code> or <code>Finalized round</code> rows. If a proposal doesn&#x27;t get accepted in a round, everyone times out and votes <code>no</code>. Otherwise, a proposal is visible to someone with a quorum of votes and will eventually be visible to everyone.</p>
</div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="some-advantages-of-zug">Some Advantages of Zug<a href="#some-advantages-of-zug" class="hash-link" aria-label="Direct link to Some Advantages of Zug" title="Direct link to Some Advantages of Zug">​</a></h2>
<ul>
<li>Apart from the leader, who has to send the proposed block, each validator node broadcasts only two tiny messages in each round, making the communication overhead very small.</li>
<li>Unlike in Highway and Practical Byzantine Fault Tolerance (PBFT), and similar to pipelined protocols like HotStuff, only one round of messages (the echoes) is needed for the next leader to propose a block, reducing the delay between a block and its child.</li>
<li>But <em>unlike</em> HotStuff, Zug can finalize a block without waiting for its child or grandchild. And, unlike Highway, it does so without waiting for any timeout. Even if a network is configured to produce only one block per minute, every block gets finalized within seconds, as fast as the network connections allow.</li>
<li>Zug&#x27;s technical description is more flexible than Highway&#x27;s, giving us a family of related, correct implementations from which to choose.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="comparison-with-highway">Comparison with Highway<a href="#comparison-with-highway" class="hash-link" aria-label="Direct link to Comparison with Highway" title="Direct link to Comparison with Highway">​</a></h2>
<p>Unlike Highway, Zug does not use a communication history DAG. Highway sends larger messages due to citing and is slower. Zug does not have any notion of citing units, as does Highway, and relies on exchanging signed messages. On the other hand, Highway allows for more fine-grained <a href="#block-rewards">block rewards</a>.</p>
<p>With Zug, finality happens after nodes constituting two-thirds of the network&#x27;s total weight vote <code>true</code> for a round in which the block was proposed or a later round that has this one as an ancestor. Highways&#x27; criterion for detecting finality is the presence of a pattern of messages called a <code>Summit.</code> Summits preserve the advantage of tunable fault tolerance while being detected in polynomial time. Both ways of detecting finality are improvements over previous CBC Casper finality criteria, which were more difficult to attain and computationally more expensive to detect.</p>
<p>Highway and Zug offer flexibility in terms of fault tolerance thresholds. Highway allows different clients to follow the protocol with varying thresholds, each with its own balance between security and latency. However, if a sufficient number of validators are online, Zug demonstrates lower latency than Highway at any threshold. This is because Zug does not have predefined, rigid values for the round length, and its design allows the network to adapt to actual delays. If delays occur, block times may vary. Otherwise, blocks should appear as soon as they are finalized. Highway has a defined minimum round length, and the round lengths have to be powers of two times that minimum. Zug has a defined minimum round length, but a round can finish anytime as soon as enough messages are successfully exchanged. So, with Zug, there is no need to wait for a power of two times the minimum if the actual time falls somewhere between.</p>
<p>Highway is a much more complicated protocol than Zug. Implementing it takes more than twice as many lines of code. Also, Highway&#x27;s proof of correctness has proved more difficult to verify than Zug&#x27;s. Zug will make it easier for third parties to create compatible node software that works with the Casper node.</p>
<p>Using Zug consensus and smaller messages, the network could scale to a larger number of validators.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="block-rewards">Block Rewards<a href="#block-rewards" class="hash-link" aria-label="Direct link to Block Rewards" title="Direct link to Block Rewards">​</a></h3>
<p>Using a DAG in Highway makes fine-grained information about the validators&#x27; behavior available temporarily in the protocol state, so block rewards can be tuned to incentivize full participation in the consensus protocol. However, this does not apply at the end of each era. Any message sent after the era&#x27;s last block was proposed cannot be taken into account, even though these messages are still needed to finalize that block. And this granularity comes at a cost: Highway messages are relatively big.</p>
<p>The current system does not reward finality signatures, which are arguably the most important outcome. The signatures are the user-visible proof, signed by the validators, that an executed block is correct.</p>
<p>In Zug, messages are much smaller, so a smaller incentive is needed to send them.</p>
<p>Casper 2.0.0 will distribute a configurable fraction of the seigniorage as a reward for finality signatures and the rest as a simple reward for each block, both proportionally to the validators&#x27; stakes.</p>
<p>This new reward system is simpler, fairer, predictable, and transparent. It will give equal weight to all blocks (including at the end of an era), but it will not take into account every single consensus message.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="read-the-paper">Read the Paper<a href="#read-the-paper" class="hash-link" aria-label="Direct link to Read the Paper" title="Direct link to Read the Paper">​</a></h2>
<p>Here, we describe Zug, an implementation of the ideas from our paper <a href="https://arxiv.org/abs/2205.06314" target="_blank" rel="noopener noreferrer">From Weakly-terminating Binary Agreement and Reliable Broadcast to Atomic Broadcast</a>. The paper, however, contains a much more general algorithm parameterized by the two subprotocols named in the title: Reliable Broadcast and Weakly-terminating Binary Agreement. In our specialization of this algorithm made for the Casper blockchain, the <em>echo</em> messages are used by our Reliable Broadcast implementation, and the <em>vote</em> messages are used by our Weakly-terminating Binary Agreement implementation.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs-redux/next/concepts/design/consensus/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Consensus in a Casper Network</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs-redux/next/concepts/design/highway/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Highway Consensus</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-zug-works" class="table-of-contents__link toc-highlight">How Zug Works</a></li><li><a href="#some-advantages-of-zug" class="table-of-contents__link toc-highlight">Some Advantages of Zug</a></li><li><a href="#comparison-with-highway" class="table-of-contents__link toc-highlight">Comparison with Highway</a><ul><li><a href="#block-rewards" class="table-of-contents__link toc-highlight">Block Rewards</a></li></ul></li><li><a href="#read-the-paper" class="table-of-contents__link toc-highlight">Read the Paper</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://casper.network/" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/docs-redux/icon/Casper_Wordmark_Horizontal_Red_RGB.png" alt="Casper Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="120" height="30"><img src="/docs-redux/icon/Casper_Wordmark_Horizontal_White_RGB.png" alt="Casper Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="120" height="30"></a></div><div class="footer__copyright">Copyright © 2024 Casper Association. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>