<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-resources/condor-for-exchanges" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Condor Release Notes for Exchanges | Casper Docs - Redux</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://casper-devrel.github.io/docs-redux/resources/condor-for-exchanges/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Condor Release Notes for Exchanges | Casper Docs - Redux"><meta data-rh="true" name="description" content="Account/Contract Merge"><meta data-rh="true" property="og:description" content="Account/Contract Merge"><link data-rh="true" rel="icon" href="/docs-redux/icon/favicon.ico"><link data-rh="true" rel="canonical" href="https://casper-devrel.github.io/docs-redux/resources/condor-for-exchanges/"><link data-rh="true" rel="alternate" href="https://casper-devrel.github.io/docs-redux/resources/condor-for-exchanges/" hreflang="en"><link data-rh="true" rel="alternate" href="https://casper-devrel.github.io/docs-redux/resources/condor-for-exchanges/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://&quot;A1AAQ71KTN&quot;;-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Casper Docs - Redux" href="/docs-redux/opensearch.xml"><link rel="stylesheet" href="/docs-redux/assets/css/styles.d4dff264.css">
<script src="/docs-redux/assets/js/runtime~main.9f0f865f.js" defer="defer"></script>
<script src="/docs-redux/assets/js/main.13d214b5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs-redux/"><div class="navbar__logo"><img src="/docs-redux/icon/Casper_Wordmark_Red_RGB.png" alt="Casper Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs-redux/icon/Casper_Wordmark_White_RGB.png" alt="Casper Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs-redux/concepts/">Concepts</a><a class="navbar__item navbar__link" href="/docs-redux/developers/">Developers</a><a class="navbar__item navbar__link" href="/docs-redux/operators/">Operators</a><a class="navbar__item navbar__link" href="/docs-redux/users/">Users</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs-redux/resources/">Resources</a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><a href="https://support.casperlabs.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://discord.com/invite/casperblockchain" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chat<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/casper-network/docs/blob/dev/README.md" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Condor Release Notes for Exchanges</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="accountcontract-merge">Account/Contract Merge<a href="#accountcontract-merge" class="hash-link" aria-label="Direct link to Account/Contract Merge" title="Direct link to Account/Contract Merge">​</a></h2>
<ul>
<li>
<p>Currently, Casper contains separate Accounts and Contracts. These record types are similar, but contain small differences. Condor merges these two into one record called AddressableEntity.</p>
<ul>
<li>
<p>All existing Account and Contract records will be migrated upon on-chain interaction (i.e., sending of transactions, native transfers).</p>
</li>
<li>
<p>All new “accounts” and “contracts” created on the system will result in an AddressableEntity record being created.</p>
</li>
<li>
<p>PublicKeys and AccountHashes for existing Account records remain in place and continue to function with the corresponding AddressableEntity record.</p>
</li>
</ul>
</li>
<li>
<p>Named keys are now a top-level concern and stored directly in global state.</p>
<ul>
<li>
<p>The outcome and behavior of named keys is the same; this is an implementation detail addressing the scalability issues of the previous design.</p>
</li>
<li>
<p>Similarly, entry points for smart contracts are now a top level concern, with each entry point being stored directly in global state rather than embedded within an AddressableEntity record..</p>
</li>
</ul>
</li>
<li>
<p><strong>Action Items: While the Casper node software handles all on-chain interactions with these new data structures, any off-chain logic that retrieves Account and/or Contract records from the blockchain for any purpose (i.e., processing, storage, indexing, etc) will need to be modified to retrieve and use the AddressableEntity record structure going forward.</strong></p>
</li>
</ul>
<h1>Fee Elimination</h1>
<ul>
<li>
<p>Condor adds support for configurable fee, refund, and pricing strategies. The current plan is to roll out Condor with “NoFee” mode on. Rather than transferring tokens from a paying purse, they are now placed on hold temporarily.</p>
</li>
<li>
<p>There is a configurable interval that determines how long a balance hold remains in effect. The available balance of a purse equals its actual total balance minus all non-expired balance holds on that purse. The held portion of a purse balance is not available to transfer or spend until it is released.</p>
<ul>
<li>The on-chain logic calculates the correct values for total balance and available balance. Off-chain logic can continue to use the existing query_balance endpoint, which will return the available balance. This is sufficient for the majority of use cases. However, off-chain logic that wants to get the full details including total, available, and all hold records can use the new query_balance_details RPC endpoint.</li>
</ul>
</li>
<li>
<p><strong>Action Items: Overall, placing holds rather than taking fees is beneficial to exchanges and other parties who send periodic transactions to the network, as their gas costs return to them over time rather than being spent.</strong></p>
<ul>
<li>
<p><strong>Existing implementations should generally not need to change anything to take advantage of this behavior of the system.</strong></p>
</li>
<li>
<p><strong>Any advanced platform with automated funding that periodically tops off operating balances with new tokens to replace spent gas would benefit from some consideration of this new behavior.</strong></p>
</li>
<li>
<p><strong>Advanced platforms seeking optimal scheduling strategies would benefit from retrieving the hold records for their operating purse(s) to calculate projected future available balances and use that to inform the scheduling of automated transaction submissions.</strong></p>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dynamic-pricing">Dynamic Pricing<a href="#dynamic-pricing" class="hash-link" aria-label="Direct link to Dynamic Pricing" title="Direct link to Dynamic Pricing">​</a></h2>
<ul>
<li>
<p>Currently, the gas price on the Casper network is equal to 1, meaning 1 unit of gas costs 1 mote. Condor introduces a configurable gas price multiplier. If turned on, at the end of each era a calculation is run to determine block usage in the current era and adjust the multiplier for the era that is starting.</p>
<ul>
<li>
<p>If overall block use rises above a threshold the gas price goes up by 1, if use falls below a threshold the gas price goes down by 1. If use remains within those thresholds the gas price remains the same.</p>
</li>
<li>
<p>The gas price will not go up or down by more than 1 in a given era, and will not go above the maximum or below the minimum threshold.</p>
</li>
<li>
<p>The minimum and maximum gas prices and the go-up and go-down threshold are configurable.</p>
</li>
<li>
<p>The current gas price is used as a straight multiplier to determine actual gas cost. For instance, an operation with a base cost of 1 CSPR would cost 1 CSPR if the current gas price is 1, but would cost 2 CSPR if the current gas price is 2.</p>
</li>
<li>
<p>The calculated gas price has been added to the block header to make it easily discoverable (for determining what the current price is), and for posterity (for determining what the gas price was for a given era in the historical context).</p>
</li>
</ul>
</li>
<li>
<p><strong>Action Items: During times of high network usage, you may find that costs for interacting with the blockchain increase. Plan accordingly for any transactions.</strong></p>
<ul>
<li><strong>As a quality of life feature for those operating on a strict budget, transactions have a gas_tolerance field, which allows the sender of a transaction to specify the maximum gas price they are willing to pay for (minimum 1). For instance, if a transaction is sent with gas_tolerance = 2 and the network is currently at gas price 3 or higher, that transaction will not be included in a proposed block. If the calculated gas price later walks down to 2 before the transaction has expired, the transaction will be eligible for inclusion in a proposed block.</strong></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="transaction-types">Transaction Types<a href="#transaction-types" class="hash-link" aria-label="Direct link to Transaction Types" title="Direct link to Transaction Types">​</a></h2>
<ul>
<li>
<p>Currently, work to be done on the Casper network is sent using the Deploy structure. With Condor we are transitioning to a Transaction model. There are some structural changes introduced to support more advanced features.</p>
</li>
<li>
<p>The existing Deploy model is deprecated as of Condor, and support will be removed entirely in a future major release. However, Condor will continue to accept valid Deploys and will attempt to execute them. Most existing deploys that function today will continue to do so. However, deploys that depend on a data type or FFI function that has been altered or removed will fail to execute.</p>
</li>
<li>
<p>Under the new Transaction model, Condor offers direct support for native / Wasm-less usage of all user-land mint and stake management actions.</p>
</li>
<li>
<p><strong>Action Items: Existing off-chain systems should determine if their operation continues to work using the legacy Deploy model support.</strong></p>
<ul>
<li>
<p><strong>In cases where legacy integration remains compatible, upgrading to take advantage of the new Transaction model can be delayed temporarily or indefinitely until the removal of Deploys with a later release.</strong></p>
</li>
<li>
<p><strong>In cases where one or more incompatibilities have been introduced, some fix short of a full upgrade to the Transaction model may be possible on a case by case basis, but a forced upgrade may be preferable or even necessary in some cases.</strong></p>
</li>
<li>
<p><strong>Even off-chain systems that continue to work using legacy support may want to consider upgrading to the new Transaction model to take advantage of efficiencies or new capabilities.</strong></p>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="block-restructure">Block Restructure<a href="#block-restructure" class="hash-link" aria-label="Direct link to Block Restructure" title="Direct link to Block Restructure">​</a></h2>
<ul>
<li>
<p>The structure of the Block record is being modified as part of Condor. As all blocks are immutable once added to the chain, previously produced blocks remain in their original format. All new blocks produced after Condor will have the new format. The change in structure can be seen <a href="https://github.com/casper-network/docs/blob/feat-2.0_docs/source/docs/casper/developers/json-rpc/types_chain.md#blockv2-blockv2" target="_blank" rel="noopener noreferrer">here in the upcoming documentation changes</a>.</p>
</li>
<li>
<p><strong>Action Items: While existing client software (including SDKs) remain able to request and parse historical blocks that use the original Block structure, they must be upgraded to request and parse new blocks if they wish to continue to follow the chain. This is the primary breaking change for most off-chain consumers of the Casper network.</strong></p>
<ul>
<li><strong>To continue to service historical/archival usage of old blocks, such software should not code over or remove handling for the original block structure. Instead they should retain that capability and add handling for the new block structure.</strong></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="contract-level-events">Contract Level Events<a href="#contract-level-events" class="hash-link" aria-label="Direct link to Contract Level Events" title="Direct link to Contract Level Events">​</a></h2>
<ul>
<li>
<p>Condor adds support for smart contracts to define message topics and emit their own messages which are passed to the event stream for consumption as contract level events. Details on this feature can be found <a href="https://github.com/casper-network/ceps/blob/master/text/0088-contract-level-messages.md" target="_blank" rel="noopener noreferrer">here</a>.</p>
</li>
<li>
<p><strong>Action Items: As this is an entirely new feature, existing systems do not have to change anything.</strong></p>
<ul>
<li><strong>Some existing smart contracts have adopted a convention using one or more dictionaries to approximate contract level events. Such smart contracts cannot directly address spoofing, and repudiation protection requires off-chain support. Thus, they should consider making the necessary changes to their logic to take advantage of the built in and safe support offered in Condor.</strong></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="zug-consensus-protocol">Zug Consensus Protocol<a href="#zug-consensus-protocol" class="hash-link" aria-label="Direct link to Zug Consensus Protocol" title="Direct link to Zug Consensus Protocol">​</a></h2>
<ul>
<li>
<p>The Zug Consensus Protocol will replace Highway on the Casper network alongside the Condor release. Other instances of a Casper network (private/hybrid networks) may choose to use either Highway or Zug.</p>
<ul>
<li>
<p>Information on Zug’s implementation can be found <a href="https://github.com/casper-network/docs/blob/feat-2.0_docs/source/docs/casper/concepts/design/zug.md" target="_blank" rel="noopener noreferrer">here</a>.</p>
</li>
<li>
<p>A more in-depth view of Zug and the theory behind it can be found <a href="https://arxiv.org/abs/2205.06314" target="_blank" rel="noopener noreferrer">here</a>.</p>
</li>
</ul>
</li>
<li>
<p><strong>Action Items: None.</strong></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="server-sent-event-sse-endpoint-changes">Server-Sent Event (SSE) Endpoint Changes<a href="#server-sent-event-sse-endpoint-changes" class="hash-link" aria-label="Direct link to Server-Sent Event (SSE) Endpoint Changes" title="Direct link to Server-Sent Event (SSE) Endpoint Changes">​</a></h2>
<ul>
<li>
<p>Due to the previously mentioned structural changes to certain record kinds, most notably the Block record structure and the transition from the Deploy model to the Transaction model, and the addition of contract level events in the form of Messages, there are breaking changes to the contents of the event stream.</p>
<ul>
<li>
<p>The changes are minor schematic changes and rather obvious; for instance instead of a DeployProcessed event there is a TransactionProcessed event, instead of a DeployExpired event there is a TransactionExpired event, and so on.</p>
</li>
<li>
<p>The overall verbs and their behavioral semantics remain the same (BlockAdded, ~Accepted, ~Processed, ~Expired, etc).</p>
</li>
</ul>
</li>
<li>
<p><strong>Action Items: Existing software (including SDKs) that deserializes the JSON produced by the SSE event stream will require updating to continue to follow the event stream post-Condor. Software that does not follow the event stream is unaffected.</strong></p>
</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#accountcontract-merge" class="table-of-contents__link toc-highlight">Account/Contract Merge</a></li><li><a href="#dynamic-pricing" class="table-of-contents__link toc-highlight">Dynamic Pricing</a></li><li><a href="#transaction-types" class="table-of-contents__link toc-highlight">Transaction Types</a></li><li><a href="#block-restructure" class="table-of-contents__link toc-highlight">Block Restructure</a></li><li><a href="#contract-level-events" class="table-of-contents__link toc-highlight">Contract Level Events</a></li><li><a href="#zug-consensus-protocol" class="table-of-contents__link toc-highlight">Zug Consensus Protocol</a></li><li><a href="#server-sent-event-sse-endpoint-changes" class="table-of-contents__link toc-highlight">Server-Sent Event (SSE) Endpoint Changes</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://casper.network/" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/docs-redux/icon/Casper_Wordmark_Horizontal_Red_RGB.png" alt="Casper Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="120" height="30"><img src="/docs-redux/icon/Casper_Wordmark_Horizontal_White_RGB.png" alt="Casper Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="120" height="30"></a></div><div class="footer__copyright">Copyright © 2024 Casper Association. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>